Dicharge_Bar_Chart <- function (drg.name, data) {
data <- head(data, 5)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
f <- "hello"
return (f)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~drg,
y = ~year ,
type = 'bar',
name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~drg,
y = ~year ,
type = 'bar',
name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~drg,
y = ~year ,
type = 'bar',
name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~drg,
y = ~year ,
type = 'bar',
name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
return ("hello")
}
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
return (data)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (data)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (dis
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
xaxis = "Year",
yaxis = "Number of Discharges")
return (discharges_bar)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Dicharge_Bar_Chart(drg.test, test)
test_chart
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown', marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge,
x = "Year",
y = "Number of Discharges")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
Dicharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "drg.name")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == "drg.name")
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data, x = ~year,y = ~discharges , type = 'bar', name = 'Discharge Breakdown')
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"</b><br>", data$medical_department)
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown') %>%
layout(title = title.discharge)
return (discharges_bar)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"(",data$medical_department, ")", "</b><br>")
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name,"(",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown') %>%
layout(title = title.discharge)
return (discharges_bar)
}
drg.test <- "039 - EXTRACRANIAL PROCEDURES W/O CC/MCC"
test <- overview.discharges
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = paste(y,"Discharges"),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~paste(discharges,"Discharges"),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges ),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
return (discharges_bar)
return (discharges_bar)
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~paste(discharges,"Discharges"),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~paste(discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
test_chart <- Discharge_Bar_Chart(drg.test, test)
test_chart
Discharge_Bar_Chart <- function (drg.name, data) {
data <-filter (data, drg == drg.name)
title.discharge <- paste0 ('<b style="color:CF000F">', "Discharge Annual Statistics for ", drg.name," (",data$medical_department, ")", "</b><br>")
f <- list( family = "Helvetica", size = 18, color = "1c1c1c")
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~paste(discharges),
textposition = 'auto') %>%
layout(title = title.discharge)
return (discharges_bar)
}
source("scripts/discharge_breakdown.r")
setwd("~/Desktop/Population Health Metrics/Project_Medi/Shiny_App")
source("scripts/discharge_breakdown.r")
runApp()
setwd("~/Desktop/Population Health Metrics/Project_Medi/Shiny_App")
# Data
overview.discharges <- read.csv("Data/year_cost_breakdown.csv", stringsAsFactors = F)
#Discharge Breakdown Bar Chart
output$discharge.breakdown.bar <- renderPlotly(Discharge_Bar_Chart(input$select.drg.discharge.brk, verview.discharges))
runApp()
runApp()
drg_all <- read.csv("Data/DRG_2011_2015.csv")
drg_state_avg_covered_charges <- drg_all %>%
group_by(state) %>%
summarise(avg_covered_charges = mean(avg_covered_charges), total_discharges = sum(discharges))
View(drg_state_avg_covered_charges)
write.csv(drg_state_avg_covered_charges, file = "Data/drg_state_avg_covered_charges.csv")
drg_state_avg_covered_charges <- ("Data/drg_state_avg_covered_charges.csv", stringsAsFactors = F)
runApp()
View(BuildPlot)
drg_state_avg_covered_charges <- read.csv("../../Data/Prepared/drg_state_avg_covered_charges.csv")
all.data <- read.csv("../../Data/Prepared/DRG_2011_2015.csv")
setwd("~/Desktop/Population Health Metrics/Project_Medi/R_Scripts/Visualizations")
all.data <- read.csv("../../Data/Prepared/DRG_2011_2015.csv")
data.2015 <- read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2015.csv")
provider.medicare.2015 <- data.2015 %>% group_by(Provider.Name) %>% summarise(avg_medicare_payments = mean(Average.Medicare.Payments))
provider.total.2015 <- data.2015 %>% group_by(Provider.Name) %>% summarise(avg_total_payments = mean(Average.Total.Payments))
provider.2015 <- provider.total.2015 %>% left_join(provider.medicare.2015, by='Provider.Name')
provider.2015 <- provider.total.2015 %>% left_join(provider.medicare.2015, by='Provider.Name')
write.csv(provider.2015, file = "../../Data/Prepared/provider_2015.csv")
provider.2015.plot.lowest <- provider.2015 %>% arrange(avg_total_payments) %>% slice(1:10)
plot.2015.lowest <- plot_ly(provider.2015.plot.lowest, x = ~reorder(Provider.Name, avg_total_payments), y= ~avg_total_payments, type="bar", marker = list(color = 'skyblue'), name = "Average Total Payments") %>%
add_trace(y = ~avg_medicare_payments, name = "Average Medicare Payments", marker = list(color = 'blue')) %>%
layout(title = "Top 10 Providers with Lowest Average Total Payments in 2015",
xaxis = list(title = 'Provider'),
yaxis = list(title = 'Average Total Payments ($)'),
barmode = "Group", margin = list(b = 160, t = 50))
plot.2015.lowest <- plot_ly(provider.2015.plot.lowest, x = ~reorder(Provider.Name, avg_total_payments), y= ~avg_total_payments, type="bar", marker = list(color = 'skyblue'), name = "Average Total Payments") %>%
add_trace(y = ~avg_medicare_payments, name = "Average Medicare Payments", marker = list(color = 'blue')) %>%
layout(title = "Top 10 Providers with Lowest Average Total Payments in 2015",
xaxis = list(title = 'Provider'),
yaxis = list(title = 'Average Total Payments ($)'),
barmode = "Group", margin = list(b = 160, t = 50))
plot.2015.lowest
provider.2015.plot.data.highest <- provider.2015 %>% arrange(-avg_total_payments) %>% slice(1:10)
plot.2015.highest <- plot_ly(provider.2015.plot.data.highest, x = ~reorder(Provider.Name, -avg_total_payments), y= ~avg_total_payments, type="bar", marker = list(color = 'dodgerblue'), name = "Average Total Payments") %>%
add_trace(y = ~avg_medicare_payments, name = "Average Medicare Payments", marker = list(color = 'lightgreen')) %>%
layout(title = "Top 10 Providers with Highest Average Total Payments in 2015",
xaxis = list(title = 'Provider'),
yaxis = list(title = 'Average Total Payments ($)'),
barmode = "Group", margin = list(b = 160, t = 50))
provider.2015.plot.data.highest <- provider.2015 %>% arrange(-avg_total_payments) %>% slice(1:10)
plot.2015.highest <- plot_ly(provider.2015.plot.data.highest, x = ~reorder(Provider.Name, -avg_total_payments), y= ~avg_total_payments, type="bar", marker = list(color = 'dodgerblue'), name = "Average Total Payments") %>%
add_trace(y = ~avg_medicare_payments, name = "Average Medicare Payments", marker = list(color = 'lightgreen')) %>%
layout(title = "Top 10 Providers with Highest Average Total Payments in 2015",
xaxis = list(title = 'Provider'),
yaxis = list(title = 'Average Total Payments ($)'),
barmode = "Group", margin = list(b = 160, t = 50))
plot.2015.highest
plot.2015.highest
write.csv("../../Data/Raw/provider.2015.plot.data.highest")
write.csv("../../Data/Raw/provider.2015.plot.data.highest")
write.csv("../../Data/Raw/provider_2015_plot_data_highest.csv")
write.csv("../../Data/Raw/provider_2015_plot_data_highest.csv")
write.csv(provider.2015.plot.data.highest,"../../Data/Prepared/provider_2015_plot_data_highest.csv")
provider.2015.plot.lowest <- provider.2015 %>% arrange(avg_total_payments) %>% slice(1:10)
write.csv(provider.2015.plot.data.lowest,"../../Data/Prepared/provider_2015_plot_data_lowest.csv")
provider.2015.plot.lowest <- provider.2015 %>% arrange(avg_total_payments) %>% slice(1:10)
write.csv(provider.2015.plot.data.lowest,"../../Data/Prepared/provider_2015_plot_data_lowest.csv")
write.csv(provider.2015.plot.lowest,"../../Data/Prepared/provider_2015_plot_data_lowest.csv")
Drgs_2011_to_2015 <- read.csv("../../Data/Prepared/DRG_2011_2015.csv")
df <- Drgs_2011_to_2015 %>% subset(select=c(year, avg_covered_charges, avg_total_payments, avg_medicare_payments)) %>% group_by(year) %>% summarise(avg_covered_charges = sum(avg_covered_charges, na.rm = TRUE), avg_total_payments = sum(avg_total_payments, na.rm = TRUE),  avg_medicare_payments = sum(avg_medicare_payments, na.rm = TRUE))
gathered.df <- df %>% gather(key, value, 2:4)
df2 <- Drgs_2011_to_2015 %>% subset(select=c(year, discharges, avg_covered_charges, avg_total_payments, avg_medicare_payments)) %>% group_by(year, discharges) %>% summarise(avg_covered_charges = sum(avg_covered_charges, na.rm = TRUE), avg_total_payments = sum(avg_total_payments, na.rm = TRUE),  avg_medicare_payments = sum(avg_medicare_payments, na.rm = TRUE))
gathered.df2 <- df2 %>% gather(key, value, 3:5)
g <- ggplot(gathered.df, aes(year, value, fill=key)) + geom_bar(stat="identity", position="dodge") + ggtitle("Cost of Payments by Discharges") +  xlab("Discharges") + ylab("Cost ($)") + labs(colour = "Payment")
ggplotly(g)
ggplotly(g)
bla <- ggplotly(g)
ggplotly(g)
# Visualize Cost of Payments by Discharges
g2<-ggplot(gathered.df2, aes(discharges, value, group=key)) +
geom_point(aes(color=key), size=2) +
ggtitle("Cost of Payments by Discharges") + xlab("Discharges") + ylab("Cost ($)") + labs(colour = "Payment")
ggplotly(g2)
# Visualize Yearly Cost data
g <- ggplot(gathered.df, aes(year, value, fill=key)) + geom_bar(stat="identity", position="dodge") + ggtitle("Cost of Payments by Discharges") +  xlab("Discharges") + ylab("Cost ($)") + labs(colour = "Payment")
ggplotly(g)
ggplotly(g2)
View(top_10_discharges)
