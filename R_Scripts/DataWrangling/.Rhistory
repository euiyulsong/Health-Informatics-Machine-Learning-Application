inpatients_2013$avg.total.payments<- as.numeric(as.character(inpatients_2013$avg.total.payments))
inpatients_2013$avg.medicare.payments <- as.numeric(as.character(inpatients_2013$avg.medicare.payments))
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the top 100 DRGs for 2011, 2012, 2013                                  #
#-----------------------------------------------------------------------------------------------#
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
write.csv(top_100_Drgs_2011_to_2013, file = "../../ProjectData/top100DRG_2011_2013.csv")
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the DRGs for 2011, 2012, 2013, 2014, 2015                              #
#-----------------------------------------------------------------------------------------------#
Drgs_2011_to_2015 <-  rbind (inpatients_2011, inpatients_2012, inpatients_2013, inpatients_2014, inpatients_2015)
write.csv(Drgs_2011_to_2015, file = "../../ProjectData/DRG_2011_2015.csv")
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the DRGs for 2014, 2015                                                #
#-----------------------------------------------------------------------------------------------#
All_Drgs_2014_to_2015 <- rbind (inpatients_2014, inpatients_2015)
write.csv(All_Drgs_2014_to_2015, file = "../../ProjectData/AllDRG_2014_2015.csv")
inpatients_2011<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2011.csv")
inpatients_2012<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2012.csv")
inpatients_2013<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2013.csv")
inpatients_2013<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2013.csv")
inpatients_2014<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2014.csv")
inpatients_2015<-read.csv("../../ProjectData/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2015.csv")
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
write.csv(top_100_Drgs_2011_to_2013, file = "../../ProjectData/Prepared/top100DRG_2011_2013.csv")
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the DRGs for 2011, 2012, 2013, 2014, 2015                              #
#-----------------------------------------------------------------------------------------------#
Drgs_2011_to_2015 <-  rbind (inpatients_2011, inpatients_2012, inpatients_2013, inpatients_2014, inpatients_2015)
write.csv(Drgs_2011_to_2015, file = "../../ProjectData/Prepared/DRG_2011_2015.csv")
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the DRGs for 2014, 2015                                                #
#-----------------------------------------------------------------------------------------------#
All_Drgs_2014_to_2015 <- rbind (inpatients_2014, inpatients_2015)
write.csv(All_Drgs_2014_to_2015, file = "../../ProjectData/Prepared/AllDRG_2014_2015.csv")
inpatients_2011<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2011.csv")
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
write.csv(top_100_Drgs_2011_to_2013, file = "../../Data/Prepared/top100DRG_2011_2013.csv")
#-----------------------------------------------------------------------------------------------#
# Creating a dataset for the DRGs for 2011, 2012, 2013, 2014, 2015                              #
#-----------------------------------------------------------------------------------------------#
Drgs_2011_to_2015 <-  rbind (inpatients_2011, inpatients_2012, inpatients_2013, inpatients_2014, inpatients_2015)
write.csv(Drgs_2011_to_2015, file = "../../Data/Prepared/DRG_2011_2015.csv")
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
write.csv(top_100_Drgs_2011_to_2013, file = "../../Data/Prepared/top100DRG_2011_2013.csv")
inpatients_2011<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2011.csv")
inpatients_2012<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2012.csv")
inpatients_2013<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2013.csv")
inpatients_2014<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2014.csv")
inpatients_2015<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2015.csv")
inpatients_2011$Year = 2011
inpatients_2012$Year = 2012
inpatients_2013$Year = 2013
inpatients_2014$Year = 2014
inpatients_2015$Year = 2015
colnames(inpatients_2011, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2012, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2013, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2014, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2015, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2011) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg.covered.charges", "avg.total.payments", "avg.medicare.payments", "year")
colnames(inpatients_2012) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg.covered.charges", "avg.total.payments", "avg.medicare.payments", "year")
colnames(inpatients_2013) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg.covered.charges", "avg.total.payments", "avg.medicare.payments", "year")
colnames(inpatients_2014) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg.covered.charges", "avg.total.payments", "avg.medicare.payments", "year")
colnames(inpatients_2015) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg.covered.charges", "avg.total.payments", "avg.medicare.payments", "year")
str(inpatients_2011)
str(inpatients_2012)
str(inpatients_2013)
str(inpatients_2014)
str(inpatients_2015)
inpatients_2011$avg.covered.charges<-parse_number(inpatients_2011$avg.covered.charges)
inpatients_2011$avg.total.payments<-parse_number(inpatients_2011$avg.total.payments)
inpatients_2011$avg.medicare.payments<-parse_number(inpatients_2011$avg.medicare.payments)
# Removing the $ sign for 2012
inpatients_2012$avg.covered.charges<-parse_number(inpatients_2012$avg.covered.charges)
inpatients_2012$avg.total.payments<-parse_number(inpatients_2012$avg.total.payments)
inpatients_2012$avg.medicare.payments<-parse_number(inpatients_2012$avg.medicare.payments)
# Removing the $ sign for 2013
inpatients_2013$avg.covered.charges<-parse_number(inpatients_2013$avg.covered.charges)
inpatients_2013$avg.total.payments<-parse_number(inpatients_2013$avg.total.payments)
inpatients_2013$avg.medicare.payments<-parse_number(inpatients_2013$avg.medicare.payments)
inpatients_2011$avg.covered.charges<- as.numeric(as.character(inpatients_2011$avg.covered.charges))
inpatients_2011$avg.total.payments<- as.numeric(as.character(inpatients_2011$avg.total.payments))
inpatients_2011$avg.medicare.payments <- as.numeric(as.character(inpatients_2011$avg.medicare.payments))
inpatients_2012$avg.covered.charges<- as.numeric(as.character(inpatients_2012$avg.covered.charges))
inpatients_2012$avg.total.payments<- as.numeric(as.character(inpatients_2012$avg.total.payments))
inpatients_2012$avg.medicare.payments <- as.numeric(as.character(inpatients_2012$avg.medicare.payments))
inpatients_2013$avg.covered.charges<- as.numeric(as.character(inpatients_2013$avg.covered.charges))
inpatients_2013$avg.total.payments<- as.numeric(as.character(inpatients_2013$avg.total.payments))
inpatients_2013$avg.medicare.payments <- as.numeric(as.character(inpatients_2013$avg.medicare.payments))
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
write.csv(top_100_Drgs_2011_to_2013, file = "../../Data/Prepared/top100DRG_2011_2013.csv")
Drgs_2011_to_2015 <-  rbind (inpatients_2011, inpatients_2012, inpatients_2013, inpatients_2014, inpatients_2015)
write.csv(Drgs_2011_to_2015, file = "../../Data/Prepared/DRG_2011_2015.csv")
All_Drgs_2014_to_2015 <- rbind (inpatients_2014, inpatients_2015)
write.csv(All_Drgs_2014_to_2015, file = "../../Data/Prepared/AllDRG_2014_2015.csv")
View(top_100_Drgs_2011_to_2013)
View(Drgs_2011_to_2015)
library(dplyr)
library(readr)
library(data.table)
library(stringr)
library(dplyr)
library(readr)
library(data.table)
library(stringr)
inpatients_2011<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2011.csv")
inpatients_2012<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2012.csv")
inpatients_2013<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2013.csv")
inpatients_2014<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2014.csv")
inpatients_2015<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2015.csv")
setwd("~/Desktop/Population Health Metrics/Project_Medi/R_Scripts/DataWrangling")
# Creating a dataframe for each year by reading the data from the csvs
inpatients_2011<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2011.csv")
inpatients_2012<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2012.csv")
inpatients_2013<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_the_Top_100_Diagnosis-Related_Groups__DRG__-_FY2013.csv")
inpatients_2014<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2014.csv")
inpatients_2015<-read.csv("../../Data/Raw/Inpatient_Prospective_Payment_System__IPPS__Provider_Summary_for_All_Diagnosis-Related_Groups__DRG__-_FY2015.csv")
drg_category <- read.csv("../../Data/Prepared/DRGs_with_categories.csv")
colnames(drg_category)<- c("drg","body_system", "medical_department", "body_part")
drg_category <- drg_category %>% select(drg, body_system, medical_department)
# Creating the DRG Category dataframe which contains all the medical categories for the DRGs
drg_category <- read.csv("../../Data/Prepared/DRGs_with_categories.csv")
colnames(drg_category)<- c("drg","body_system", "medical_department", "body_part")
colnames(drg_category)<- c("drg","body_system", "medical_department")
# Adding a year column to each dataset
inpatients_2011$Year = 2011
inpatients_2012$Year = 2012
inpatients_2011$Year = 2011
inpatients_2012$Year = 2012
inpatients_2013$Year = 2013
inpatients_2014$Year = 2014
inpatients_2015$Year = 2015
colnames(inpatients_2011, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2012, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2013, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2014, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2015, do.NULL = TRUE, prefix = "col")
colnames(inpatients_2011) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg_covered_charges", "avg_total_payments", "avg_medicare_payments", "year")
colnames(inpatients_2012) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg_covered_charges", "avg_total_payments", "avg_medicare_payments", "year")
colnames(inpatients_2013) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg_covered_charges", "avg_total_payments", "avg_medicare_payments", "year")
colnames(inpatients_2014) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg_covered_charges", "avg_total_payments", "avg_medicare_payments", "year")
colnames(inpatients_2015) <- c("drg", "id", "provider", "address", "city", "state", "zipcode", "region", "discharges", "avg_covered_charges", "avg_total_payments", "avg_medicare_payments", "year")
str(inpatients_2011)
str(inpatients_2012)
str(inpatients_2013)
str(inpatients_2014)
str(inpatients_2015)
# Removing the $ sign for 2011
inpatients_2011$avg_covered_charges<-parse_number(inpatients_2011$avg_covered_charges)
inpatients_2011$avg_total_payments<-parse_number(inpatients_2011$avg_total_payments)
inpatients_2011$avg_medicare_payments<-parse_number(inpatients_2011$avg_medicare_payments)
# Removing the $ sign for 2012
inpatients_2012$avg_covered_charges<-parse_number(inpatients_2012$avg_covered_charges)
inpatients_2012$avg_total_payments<-parse_number(inpatients_2012$avg_total_payments)
inpatients_2012$avg_medicare_payments<-parse_number(inpatients_2012$avg_medicare_payments)
# Removing the $ sign for 2013
inpatients_2013$avg_covered_charges<-parse_number(inpatients_2013$avg_covered_charges)
inpatients_2013$avg_total_payments<-parse_number(inpatients_2013$avg_total_payments)
inpatients_2013$avg_medicare_payments<-parse_number(inpatients_2013$avg_medicare_payments)
Drgs_2011_to_2015 <-  rbind (inpatients_2011, inpatients_2012, inpatients_2013, inpatients_2014, inpatients_2015)
Drgs_2011_to_2015<- Drgs_2011_to_2015 %>% merge(drg_category, by = "drg")
top_100_Drgs_2011_to_2013 <- rbind (inpatients_2011, inpatients_2012, inpatients_2013)
top_100_Drgs_2011_to_2013 <- top_100_Drgs_2011_to_2013 %>% merge(drg_category, by = "drg")
All_Drgs_2014_to_2015 <- rbind (inpatients_2014, inpatients_2015)
All_Drgs_2014_to_2015 <- All_Drgs_2014_to_2015 %>% merge(drg_category, by = "drg")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",
"003 - ECMO OR TRACH W MV >96 HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC",
"065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC",
"457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR EXT FUS W CC")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS",
"870 - SEPTICEMIA OR SEVERE SEPSIS W MV >96 HOURS")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC",
"872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV >96 HOURS W/O MCC")
Drgs_2011_to_2015$drg <- replace(as.character(Drgs_2011_to_2015$drg),
Drgs_2011_to_2015$drg == "927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT",
"927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV >96 HRS W SKIN GRAFT")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",
"003 - ECMO OR TRACH W MV >96 HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC",
"065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC",
"457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR EXT FUS W CC")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS",
"870 - SEPTICEMIA OR SEVERE SEPSIS W MV >96 HOURS")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC",
"872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV >96 HOURS W/O MCC")
top_100_Drgs_2011_to_2013$drg <- replace(as.character(top_100_Drgs_2011_to_2013$drg),
top_100_Drgs_2011_to_2013$drg == "927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT",
"927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV >96 HRS W SKIN GRAFT")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "003 - ECMO OR TRACH W MV 96+ HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.",
"003 - ECMO OR TRACH W MV >96 HRS OR PDX EXC FACE, MOUTH & NECK W MAJ O.R.")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC",
"065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC OR TPA IN 24 HRS")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR 9+ FUS W CC",
"457 - SPINAL FUS EXC CERV W SPINAL CURV/MALIG/INFEC OR EXT FUS W CC")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS",
"870 - SEPTICEMIA OR SEVERE SEPSIS W MV >96 HOURS")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC",
"872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV >96 HOURS W/O MCC")
All_Drgs_2014_to_2015$drg <- replace(as.character(All_Drgs_2014_to_2015$drg),
All_Drgs_2014_to_2015$drg == "927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV 96+ HRS W SKIN GRAFT",
"927 - EXTENSIVE BURNS OR FULL THICKNESS BURNS W MV >96 HRS W SKIN GRAFT")
write.csv(top_100_Drgs_2011_to_2013, file = "../../Data/Prepared/top100DRG_2011_2013.csv", row.names=FALSE)
write.csv(Drgs_2011_to_2015, file = "../../Data/Prepared/DRG_2011_2015.csv", row.names=FALSE)
write.csv(All_Drgs_2014_to_2015, file = "../../Data/Prepared/AllDRG_2014_2015.csv", row.names=FALSE)
setwd("~/Desktop/Population Health Metrics/Project_Medi/R_Scripts/DataWrangling")
library(plotly)
library(ggplot2)
library(dplyr)
library(tidyr)
library(plotly)
library(ggplot2)
library(dplyr)
library(tidyr)
all_DRGdata <- read.csv("../../Data/Prepared/DRG_2011_2015.csv")
DRG_overall_discharges <- all_DRGdata %>% group_by(year, drg) %>% summarise (discharges = sum(discharges)) %>% spread( year, discharges)
DRG_overall_discharges[is.na(DRG_overall_discharges)] <- 0
DRG_overall_discharges <- DRG_overall_discharges %>% mutate(total_discharges = DRG_overall_discharges$`2011` +
DRG_overall_discharges$`2012` +
DRG_overall_discharges$`2013`+
DRG_overall_discharges$`2014`+
DRG_overall_discharges$`2015`) %>% arrange (-total_discharges)
colnames()
write.csv(DRG_overall_discharges, file = "../../Data/Prepared/overall_drg_discharges.csv", row.names=FALSE)
write.csv(DRG_overall_discharges, file = "../../Data/Prepared/overall_drg_discharges.csv", row.names=FALSE)
# Creating a column called total for the total amount of discharges
DRG_overall_discharges <- DRG_overall_discharges %>% mutate(total_discharges = DRG_overall_discharges$`2011` +
DRG_overall_discharges$`2012` +
DRG_overall_discharges$`2013`+
DRG_overall_discharges$`2014`+
DRG_overall_discharges$`2015`) %>% arrange (-total_discharges)
write.csv(DRG_overall_discharges, file = "../../Data/Prepared/overall_drg_discharges.csv", row.names=FALSE)
top_5_discharges <- head(DRG_overall_discharges, 5)
write.csv(top_5_discharges, file = "../../Data/Prepared/top_5_discharges.csv", row.names=FALSE)
top_10_discharges <- head(DRG_overall_discharges, 10)
write.csv(top_10_discharges, file = "../../Data/Prepared/top_10_discharges.csv", row.names=FALSE)
top_20_discharges <- head(DRG_overall_discharges, 20)
# All DRG Data for 2011 - 2015
all_DRGdata <- read.csv("../../Data/Prepared/DRG_2011_2015.csv")
View(all_DRGdata)
###############################################################################################
# Overall Discharges
# Spreading the data so that each year is a column
DRG_overall_discharges <- all_DRGdata %>% group_by(year, drg) %>% summarise (discharges = sum(discharges)) %>% spread( year, discharges)
# Making all NA Values 0
DRG_overall_discharges[is.na(DRG_overall_discharges)] <- 0
# Creating a column called total for the total amount of discharges
DRG_overall_discharges <- DRG_overall_discharges %>% mutate(total_discharges = DRG_overall_discharges$`2011` +
DRG_overall_discharges$`2012` +
DRG_overall_discharges$`2013`+
DRG_overall_discharges$`2014`+
DRG_overall_discharges$`2015`) %>% arrange (-total_discharges)
write.csv(DRG_overall_discharges, file = "../../Data/Prepared/overall_drg_discharges.csv", row.names=FALSE)
top_5_discharges <- head(DRG_overall_discharges, 5)
write.csv(top_5_discharges, file = "../../Data/Prepared/top_5_discharges.csv", row.names=FALSE)
top_10_discharges <- head(DRG_overall_discharges, 10)
write.csv(top_10_discharges, file = "../../Data/Prepared/top_10_discharges.csv", row.names=FALSE)
top_20_discharges <- head(DRG_overall_discharges, 20)
write.csv(top_20_discharges, file = "../../Data/Prepared/top_20_discharges.csv", row.names=FALSE)
View(top_20_discharges)
top_50_discharges <- head(DRG_overall_discharges, 50)
write.csv(top_50_discharges, file = "../../Data/Prepared/top_50_discharges.csv", row.names=FALSE)
top_100_discharges <- head(DRG_overall_discharges, 100)
write.csv(top_100_discharges, file = "../../Data/Prepared/top_100_discharges.csv", row.names=FALSE)
# Overall Average Total Payments
DRG_overall_avg_total_payments <- all_DRGdata %>% group_by(year, drg) %>% summarise (avg_total_payments = mean(avg_total_payments)) %>% spread( year, avg_total_payments)
DRG_overall_avg_total_payments[is.na(DRG_overall_avg_total_payments)] <- 0
DRG_overall_avg_total_payments <- DRG_overall_avg_total_payments %>% mutate(avg_total_payments = ((DRG_overall_avg_total_payments$`2011` +
DRG_overall_avg_total_payments$`2012` +
DRG_overall_avg_total_payments$`2013`+
DRG_overall_avg_total_payments$`2014`+
DRG_overall_avg_total_payments$`2015`)/5)) %>% arrange(-avg_total_payments)
write.csv(DRG_overall_avg_total_payments, file = "../../Data/Prepared/overall_drg_avg_total_payments.csv", row.names=FALSE)
top_5_avg_total_payments <- head(DRG_overall_avg_total_payments, 5)
write.csv(top_5_avg_total_payments, file = "../../Data/Prepared/top_5_avg_total_payments.csv", row.names=FALSE)
top_10_avg_total_payments <- head(DRG_overall_avg_total_payments, 10)
write.csv(top_10_avg_total_payments, file = "../../Data/Prepared/top_10_avg_total_payments.csv", row.names=FALSE)
top_20_avg_total_payments <- head(DRG_overall_avg_total_payments, 20)
write.csv(top_20_avg_total_payments, file = "../../Data/Prepared/top_20_avg_total_payments.csv", row.names=FALSE)
top_50_avg_total_payments <- head(DRG_overall_avg_total_payments, 50)
write.csv(top_50_avg_total_payments , file = "../../Data/Prepared/top_50_avg_total_payments.csv", row.names=FALSE)
top_100_avg_total_payments <- head(DRG_overall_avg_total_payments, 100)
write.csv(top_100_avg_total_payments, file = "../../Data/Prepared/top_100_avg_total_payments.csv", row.names=FALSE)
# Overall Average Medicare Payments
DRG_overall_avg_medicare_payments <- all_DRGdata %>% group_by(year, drg) %>% summarise (avg_medicare_payments = mean(avg_medicare_payments)) %>% spread( year, avg_medicare_payments)
DRG_overall_avg_medicare_payments[is.na(DRG_overall_avg_medicare_payments)] <- 0
DRG_overall_avg_medicare_payments <- DRG_overall_avg_medicare_payments %>% mutate(avg_medicare_payments = ((DRG_overall_avg_medicare_payments$`2011` +
DRG_overall_avg_medicare_payments$`2012` +
DRG_overall_avg_medicare_payments$`2013`+
DRG_overall_avg_medicare_payments$`2014`+
DRG_overall_avg_medicare_payments$`2015`)/5)) %>% arrange(-avg_medicare_payments)
write.csv(DRG_overall_avg_medicare_payments, file = "../../Data/Prepared/overall_drg_avg_medicare_payments.csv", row.names=FALSE)
top_5_avg_medicare_payments <- head(DRG_overall_avg_medicare_payments, 5)
write.csv(top_5_avg_medicare_payments, file = "../../Data/Prepared/top_5_avg_medicare_payments.csv", row.names=FALSE)
top_10_avg_medicare_payments <- head(DRG_overall_avg_medicare_payments, 10)
write.csv(top_10_avg_medicare_payments, file = "../../Data/Prepared/top_10_avg_medicare_payments.csv", row.names=FALSE)
top_20_avg_medicare_payments <- head(DRG_overall_avg_medicare_payments, 20)
write.csv(top_20_avg_medicare_payments, file = "../../Data/Prepared/top_20_avg_medicare_payments.csv", row.names=FALSE)
top_50_avg_medicare_payments <- head(DRG_overall_avg_medicare_payments, 50)
write.csv(top_50_avg_medicare_payments, file = "../../Data/Prepared/top_50_avg_medicare_payments.csv", row.names=FALSE)
top_100_avg_medicare_payments <- head(DRG_overall_avg_medicare_payments, 100)
write.csv(top_100_avg_medicare_payments, file = "../../Data/Prepared/top_100_avg_medicare_payments.csv", row.names=FALSE)
# Overall Average Covered Charges
DRG_overall_avg_covered_charges <- all_DRGdata %>% group_by(year, drg) %>% summarise (avg_covered_charges = mean(avg_covered_charges)) %>% spread( year, avg_covered_charges)
DRG_overall_avg_covered_charges[is.na(DRG_overall_avg_covered_charges)] <- 0
DRG_overall_avg_covered_charges <- DRG_overall_avg_covered_charges %>% mutate(avg_covered_charges = ((DRG_overall_avg_covered_charges$`2011` +
DRG_overall_avg_covered_charges$`2012` +
DRG_overall_avg_covered_charges$`2013`+
DRG_overall_avg_covered_charges$`2014`+
DRG_overall_avg_covered_charges$`2015`)/5)) %>% arrange(-avg_covered_charges)
View(DRG_overall_avg_covered_charges)
write.csv(DRG_overall_avg_covered_charges, file = "../../Data/Prepared/overall_drg_avg_covered_charges.csv", row.names=FALSE)
top_5_avg_covered_charges <- head(DRG_overall_avg_covered_charges, 5)
write.csv(top_5_avg_covered_charges, file = "../../Data/Prepared/top_5_avg_covered_charges.csv", row.names=FALSE)
top_10_avg_covered_charges <- head(DRG_overall_avg_covered_charges, 10)
write.csv(top_10_avg_covered_charges, file = "../../Data/Prepared/top_10_avg_covered_charges.csv", row.names=FALSE)
top_20_avg_covered_charges <- head(DRG_overall_avg_covered_charges, 20)
write.csv(top_20_avg_covered_charges, file = "../../Data/Prepared/top_20_avg_covered_charges.csv", row.names=FALSE)
top_50_avg_covered_charges <- head(DRG_overall_avg_covered_charges, 50)
write.csv(top_50_avg_covered_charges, file = "../../Data/Prepared/top_50_avg_covered_charges.csv", row.names=FALSE)
top_100_avg_covered_charges <- head(DRG_overall_avg_covered_charges, 100)
write.csv(top_100_avg_covered_charges, file = "../../Data/Prepared/top_100_avg_covered_charges.csv", row.names=FALSE)
all_drgs<-DRG_overall_discharges %>% select(drg)
write.csv(all_drgs, file = "../../Data/Prepared/all_drgs.csv", row.names=FALSE)
cost_breakdown<- all_DRGdata %>% group_by(drg) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
write.csv(cost_breakdown, file = "../../Data/Prepared/cost_breakdown.csv", row.names=FALSE)
top_10_discharge_costs <- head(cost_breakdown, 10)
source('~/Desktop/Population Health Metrics/Project_Medi/R_Scripts/DataWrangling/overall_drg_stats_wrangler.R', echo=TRUE)
top_20_discharge_costs <- head(cost_breakdown, 20)
top_50_discharge_costs <- head(cost_breakdown, 50)
top_100_discharge_costs <-head(cost_breakdown, 100)
year_cost_breakdown <- all_DRGdata %>% group_by(drg, year, medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
write.csv(year_cost_breakdown, file = "../../Data/Prepared/year_cost_breakdown.csv", row.names=FALSE)
top_100_discharge_names <- top_100_discharges %>% select(drg)
year_cost_breakdown_100 <- year_cost_breakdown %>% semi_join(top_100_discharge_names, by = "drg")
write.csv(year_cost_breakdown_100 , file = "../../Data/Prepared/year_cost_breakdown_100.csv", row.names=FALSE)
top_10_discharges <- read.csv("../../Data/Prepared/top_10_discharges.csv")
top_10_discharges <- top_10_discharges %>% arrange(total_discharges)
colnames(top_10_discharges) <- c("drg","2011", "2012", "2013", "2014", "2015", "total")
f <- list( family = "Open Sans, Sans Serif, monospace", size = 18, color = "#7f7f7f")
x <- list( title = "DRG", titlefont = f)
y <- list( title = "Number of Discharges", titlefont = f)
View(top_10_discharges)
View(year_cost_breakdown)
year_cost_breakdown <- all_DRGdata %>% group_by(drg, year, medical_department, biology_system) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
year_cost_breakdown <- all_DRGdata %>% group_by(drg, year, medical_department, body_system) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
View(year_cost_breakdown)
medical_department_breakdown <- year_cost_breakdown %>% group_by(medical_department, body_system, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payment),
avg_covered_charge = mean(avg_covered_charge),
avg_total_payment = mean(avg_total_payment)) %>% arrange (-discharges)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, body_system, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payment),
avg_covered_charge = mean(avg_covered_charge),
avg_total_payment = mean(avg_total_payment)) %>% arrange (-discharges)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, body_system, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
View(medical_department_breakdown)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
View(medical_department_breakdown)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>%
arrange (-discharges) %>%
spread(year, discharges,  avg_medicare_payment, avg_covered_charge, avg_total_payment)
medical_department_breakdown_discharges <- medical_department_breakdown %>% select(medical_department, year, discharges)
medical_department_breakdown_discharges <- spread(medical_department_breakdown_discharges, year, discharges)
View(medical_department_breakdown_discharges)
medical_department_breakdown_discharges[is.na(medical_department_breakdown_discharges] <- 0
medical_department_breakdown_discharges[is.na(medical_department_breakdown_discharges)] <- 0
View(medical_department_breakdown_discharges)
source('~/Desktop/Population Health Metrics/Project_Medi/R_Scripts/DataWrangling/overall_drg_stats_wrangler.R')
medical_department_breakdown_discharges <- medical_department_breakdown_discharges %>% mutate(total = `2011` + `2012` + `2013` + `2014` + `2015`)
View(medical_department_breakdown_discharges)
medical_department_breakdown_discharges <- medical_department_breakdown_discharges %>% mutate(total = `2011` + `2012` + `2013` + `2014` + `2015`) %>% arrange(-total)
View(medical_department_breakdown_discharges)
write.csv(year_cost_breakdown, file = "../../Data/Prepared/medical_department_breakdown_discharges.csv", row.names=FALSE)
View(medical_department_breakdown)
medical_department_breakdown_payments <- medical_department_breakdown %>% select(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
medical_department_breakdown_payments <- medical_department_breakdown %>% select(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
View(medical_department_breakdown)
medical_department_breakdown_payments <- medical_department_breakdown %>% select(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments))
medical_department_breakdown_payments <- medical_department_breakdown %>% group_by(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange(-discharges)
medical_department_breakdown_payments <- medical_department_breakdown %>% group_by(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payment),
avg_covered_charge = mean(avg_covered_charge),
avg_total_payment = mean(avg_total_payment)) %>% arrange(-discharges)
write.csv(year_cost_breakdown, file = "../../Data/Prepared/medical_department_breakdown_payments.csv", row.names=FALSE)
write.csv(medical_department_breakdown_discharges, file = "../../Data/Prepared/medical_department_breakdown_discharges.csv", row.names=FALSE)
medical_department_breakdown <- all_DRGdata %>% group_by(medical_department, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
medical_department_breakdown_discharges <- medical_department_breakdown %>% select(medical_department, year, discharges)
medical_department_breakdown_discharges <- spread(medical_department_breakdown_discharges, year, discharges)
medical_department_breakdown_discharges[is.na(medical_department_breakdown_discharges)] <- 0
medical_department_breakdown_discharges <- medical_department_breakdown_discharges %>% mutate(total = `2011` + `2012` + `2013` + `2014` + `2015`) %>% arrange(-total)
write.csv(medical_department_breakdown_discharges, file = "../../Data/Prepared/medical_department_breakdown_discharges.csv", row.names=FALSE)
medical_department_breakdown_payments <- medical_department_breakdown %>% group_by(medical_department) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payment),
avg_covered_charge = mean(avg_covered_charge),
avg_total_payment = mean(avg_total_payment)) %>% arrange(-discharges)
write.csv(medical_department_breakdown_payments, file = "../../Data/Prepared/medical_department_breakdown_payments.csv", row.names=FALSE)
body_system_breakdown <- all_DRGdata %>% group_by(body_system, year) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payments),
avg_covered_charge = mean(avg_covered_charges),
avg_total_payment = mean(avg_total_payments)) %>% arrange (-discharges)
body_system_breakdown_discharges <- body_system_breakdown %>% select(body_system, year, discharges)
body_system_breakdown_discharges <- spread(body_system_breakdown_discharges, year, discharges)
body_system_breakdown_discharges[is.na(body_system_breakdown_discharges)] <- 0
body_system_breakdown_discharges <- body_system_breakdown_discharges %>% mutate(total = `2011` + `2012` + `2013` + `2014` + `2015`) %>% arrange(-total)
write.csv(body_system_breakdown_discharges, file = "../../Data/Prepared/body_system_breakdown_discharges.csv", row.names=FALSE)
body_system_breakdown_payments <- body_system_breakdown %>% group_by(body_system) %>% summarise (discharges = sum(discharges),
avg_medicare_payment = mean(avg_medicare_payment),
avg_covered_charge = mean(avg_covered_charge),
avg_total_payment = mean(avg_total_payment)) %>% arrange(-discharges)
write.csv(body_system_breakdown_payments, file = "../../Data/Prepared/body_system_breakdown_payments.csv", row.names=FALSE)
medical_dept_discharge <- read.csv("../../Data/Prepared/medical_department_breakdown_discharges.csv")
medical_dept_discharge  <- medical_dept_discharge  %>% arrange(total)
medical_dept_discharge <- read.csv("../../Data/Prepared/medical_department_breakdown_discharges.csv")
medical_dept_discharge  <- medical_dept_discharge  %>% arrange(total)
View(medical_dept_discharge )
medical_dept_discharge <- head(medical_dept_discharge, 20)
cost_breakdown_chart <- plot_ly(cost_breakdown,
y = ~reorder(drg, discharges),
x = ~avg_covered_charge,
type = 'bar',
name = 'Average Covered Charges',
marker = list(color = '#31A4DB'),
orientation = "h") %>%
add_trace(x = ~avg_total_payment, name = 'Average Total Payments', marker = list(color = '#9EC43C')) %>%
add_trace(x = ~avg_medicare_payment, name = 'Average Medicare Charges', marker = list(color = 'F6AB3B')) %>%
layout(height = 500,
title = "Cost Breakdown for the DRGs with Most Discharges - Top 10",
font = t,
xaxis = list(title = 'Cost ($)'),
yaxis = list(title = ''),
barmode = 'group', margin = list(l = 420,t = 50, pad = 4),
xaxis = list(tickangle = 45),
legend = list(title = 'Legend',
font = list( family = "sans-serif",
size = 10,
color = "#000"),
bgcolor = "FFFFFF",
bordercolor = "#0a3d62",
borderwidth = 0.5))
shiny::runApp('~/Desktop/Population Health Metrics/Project_Medi/Shiny_App')
discharges_bar <- plot_ly(data,
x = ~year,
y = ~discharges,
type = 'bar',
name = 'Discharge Breakdown',
text = ~paste(discharges),
textposition = 'auto',
marker = list(color = '#25CCF7')) %>%
layout(title = title.discharge)
runApp('~/Desktop/Population Health Metrics/Project_Medi/Shiny_App')
runApp('~/Desktop/Population Health Metrics/Project_Medi/Shiny_App')
runApp('~/Desktop/Population Health Metrics/Project_Medi/Shiny_App')
runApp('~/Desktop/Population Health Metrics/Project_Medi/Shiny_App')
